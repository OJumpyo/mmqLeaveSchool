<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <title>北邮体育馆</title>
    <link rel="stylesheet" href="bootstrap.min.css">
    <link rel="stylesheet" href="font-awesome.min.css">
    <link rel="stylesheet" href="main.css"/>
    <link rel="stylesheet" href="my_register.css"/>
    <style id="__WXWORK_INNER_SCROLLBAR_CSS">::-webkit-scrollbar {
        width: 12px !important;
        height: 12px !important;
    }

    ::-webkit-scrollbar-track:vertical {
    }

    ::-webkit-scrollbar-thumb:vertical {
        background-color: rgba(136, 141, 152, 0.5) !important;
        border-radius: 10px !important;
        background-clip: content-box !important;
        border: 2px solid transparent !important;
    }

    ::-webkit-scrollbar-track:horizontal {
    }

    ::-webkit-scrollbar-thumb:horizontal {
        background-color: rgba(136, 141, 152, 0.5) !important;
        border-radius: 10px !important;
        background-clip: content-box !important;
        border: 2px solid transparent !important;
    }

    ::-webkit-resizer {
        display: none !important;
    }</style>
</head>
<body>
<header class="header">
    <div class="header-title">
        <div class="col-xs-2">
            <a href="/index.php/Wechat/Show/index"><img src="left.png"></a>
        </div>
        <div class="col-xs-8" style="font-size 15px;">
            <h1 class="title">我的今日预约</h1>

        </div>
    </div>
</header>
<!--<div>-->
<!--<a href="/index.php/Wechat/Personal/register_list">-->

<!--<p></p>-->
<!--</a>-->
<!--</div>-->
<section class="my_register">
    <!--<a href="/index.php/Wechat/Personal/register_list">-->
    <!--<div class="media">-->
    <!--<div class="media-left">-->
    <!--<img src="//storage.joyreserve.com/Public/Wechat/img/calender.png"/>-->
    <!--</div>-->
    <!--<div class="media-body">-->
    <!--<h3>我的今日预约表</h3>-->
    <!--</div>-->
    <!--<div class="media-right">-->
    <!--<img src="//storage.joyreserve.com/Public/Wechat/img/right.png"/>-->
    <!--</div>-->
    <!--</div>-->
    <!--</a>-->
    <div class="list">
        <div class="list-one"
             style="background: white;border-radius: 7px;padding: 20px;margin-bottom:8px;max-height: 50%;">
            <!--签到成功字体是灰色#999999-->
            <div class="reserve-place" style="float:left;min-width: 180px;font-size: 23px;color: #030303;">健身房</div>
            <!--预约地点-->
            <h5 class="reserve-id" style="float:right;font-size: 13.5px;margin-top: 13px;color:#030303;">#1293957</h5>
            <!--预约编号-->
            <!-- <h5 id="reserve_tag">
                                        </h5> -->
            <div class="discription" id="order_section"
                 style="margin-top: 44px;border-top: 1px solid #E5E5E5;padding-top: 15px; font-size: 15px;color: #030303;">
                预约时间：2022-05-26 20:30-22:00
            </div>


            <!--签到成功的颜色#FFA287-->
            <a href="gif.html"
               style="margin-top:15px;color: white;border-radius: 5px;background-color: #FF5626;font-size: 17px;text-align: center;padding:11px 0;width: 100%;display: inline-block;">签到 </a>
        </div>
    </div>
    </div>
</section>


<script type="text/javascript">


    //点击签到
    function attend(reservation_id, time_id) {
        window.location.href = "/index.php/Wechat/Attend/orders_attend?reservation_id=" + reservation_id + "&time_id=" + time_id;
    }

    //点击d订单签到
    function attend_order(reservation_id, time_id) {
        window.location.href = "/index.php/Wechat/Attend/orders_attend_order?reservation_id=" + reservation_id + "&time_id=" + time_id;
    }

    // 判断当前场次信息
    function checkOrderSection(beginTime, endTime) {

        var nowDate = new Date();
        var beginDate = new Date(nowDate);
        var endDate = new Date(nowDate);

        var beginIndex = beginTime.lastIndexOf("\:");
        var beginHour = beginTime.substring(0, beginIndex);
        var beginMinue = beginTime.substring(beginIndex + 1, beginTime.length);
        beginDate.setHours(beginHour, beginMinue, 0, 0);

        var endIndex = endTime.lastIndexOf("\:");
        var endHour = endTime.substring(0, endIndex);
        var endMinue = endTime.substring(endIndex + 1, endTime.length);
        endDate.setHours(endHour, endMinue, 0, 0);
        

        return nowDate.getTime() - beginDate.getTime() >= 0 && nowDate.getTime() <= endDate.getTime();
    }

    //输出结果，日期 + 当前场次是哪一场
    function getOrderInfo(objD) {
        var str, res;
        var yy = objD.getFullYear();
        var MM = objD.getMonth() + 1;
        if (MM < 10) MM = '0' + MM;
        var dd = objD.getDate();
        if (dd < 10) dd = '0' + dd;
        var hh = objD.getHours();
        if (hh < 10) hh = '0' + hh;
        var mm = objD.getMinutes();
        if (mm < 10) mm = '0' + mm;
        var ss = objD.getSeconds();
        if (ss < 10) ss = '0' + ss;

        //截止签到时间，在此之前的对应当前场次，否则输出下一场次信息
        // const times = ["00:00", "09:30", "12:00", "14:30", "17:00", "19:30", "22:00"];
        // const sections = ["08:00-09:30", "08:00-09:30", "10:30-12:00", "13:00-14:30", "15:30-17:00", "18:00-19:30", "20:30-22:00"];
        const times = ["00:00", "08:30", "09:30", "10:30", "12:30", "13:30", "14:30", "15:30", "17:30", "18:30", "19:30", "20:30", "21:30"];
        const sections = ["08:00-09:00", "08:00-09:00", "09:00-10:00",  "10:00-11:00", "12:00-13:00", "13:00-14:00", "14:00-15:00", "15:00-16:00",
                            "17:00-18:00", "18:00-19:00", "19:00-20:00", "20:00-21:00", "21:00-22:00"];
        for (let i = 1; i < times.length; i++) {
            if(checkOrderSection(times[i-1], times[i])) {
                str = sections[i];
                break;
            }
        }
        res = "预约时间：" + yy + "-" + MM + "-" + dd + " " + str;
        return (res);
    }
    document.getElementById("order_section").innerText = getOrderInfo(new Date());

</script>
</body>
</html>